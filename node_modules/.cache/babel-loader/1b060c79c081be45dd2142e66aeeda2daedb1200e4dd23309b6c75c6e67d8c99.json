{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { userLogin } from '@/api/user';\nimport { Message } from 'element-ui';\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport router from '@/router';\nVue.use(Vuex);\nconst store = new Vuex.Store({\n  state: {\n    user: localStorage.getItem('username'),\n    token: localStorage.getItem('token'),\n    navList: JSON.parse(localStorage.getItem('navList')) //左侧导航栏数据\n  },\n\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    },\n    setuser(state, user) {\n      state.user = user;\n    },\n    setNavList(state, navList) {\n      state.navList = navList;\n    }\n  },\n  actions: {\n    login({\n      commit\n    }, data) {\n      return new Promise((resolve, reject) => {\n        userLogin({\n          username: data.username,\n          password: data.password,\n          phone: data.phone\n        }).then(res => {\n          console.log('登录', res);\n          if (res.code == 200) {\n            const token = res.data.token;\n            const user = res.data.user;\n            const navList = res.data.navList;\n            commit('setToken', token);\n            commit('setuser', user);\n            commit('setNavList', navList);\n            localStorage.setItem('token', token);\n            localStorage.setItem('username', user);\n            localStorage.setItem('navList', JSON.stringify(navList));\n            router.push('/Worktable').catch(() => {});\n            resolve();\n          } else {\n            Message({\n              message: '登陆失败  稍后重试',\n              type: \"error\",\n              duration: 3000\n            });\n          }\n        }).catch(error => {\n          Message({\n            message: '系统错误',\n            type: \"error\",\n            duration: 3000\n          });\n          reject(error);\n        });\n      });\n    }\n  }\n});\nexport default store;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}