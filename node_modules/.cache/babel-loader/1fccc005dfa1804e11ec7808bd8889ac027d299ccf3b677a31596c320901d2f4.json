{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { userLogin } from '@/api/user';\nimport { Message } from 'element-ui';\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport router from '@/router';\nVue.use(Vuex);\nconst store = new Vuex.Store({\n  state: {\n    user: \"游客\",\n    token: localStorage.getItem('token')\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    },\n    setuser(state, user) {\n      state.user = user;\n    }\n  },\n  actions: {\n    login({\n      commit\n    }, data) {\n      return new Promise((resolve, reject) => {\n        userLogin({\n          username: data.username,\n          password: data.password\n        }).then(res => {\n          console.log(res);\n          if (res.code == 200) {\n            const token = res.data.token;\n            const user = res.data.user;\n            commit('setToken', token);\n            commit('setuser', user);\n            localStorage.setItem('token', token);\n            router.push('/home').catch(() => {});\n            resolve();\n          } else {\n            Message({\n              message: '登陆失败  稍后重试',\n              type: \"error\",\n              duration: 3000\n            });\n            router.push('/login');\n          }\n        }).catch(error => {\n          Message({\n            message: '系统错误',\n            type: \"error\",\n            duration: 3000\n          });\n          reject(error);\n        });\n      });\n    }\n  }\n});\nexport default store;","map":{"version":3,"names":["userLogin","Message","Vue","Vuex","router","use","store","Store","state","user","token","localStorage","getItem","mutations","setToken","setuser","actions","login","commit","data","Promise","resolve","reject","username","password","then","res","console","log","code","setItem","push","catch","message","type","duration","error"],"sources":["D:/Lowcode/vue-low-code/src/store/user.js"],"sourcesContent":["import { userLogin } from '@/api/user'\r\nimport { Message } from 'element-ui'\r\nimport Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport router from '@/router'\r\nVue.use(Vuex)\r\n\r\nconst store = new Vuex.Store({\r\n    state: {\r\n        user:\"游客\",\r\n        token: localStorage.getItem('token')\r\n    },\r\n    mutations: {\r\n        setToken(state, token) {\r\n            state.token = token\r\n        },\r\n        setuser(state,user){\r\n            state.user = user\r\n        }\r\n    },\r\n    actions: {\r\n        login({ commit }, data) {\r\n           return new Promise((resolve,reject)=>{\r\n            userLogin({username:data.username,password:data.password}).then((res) => {\r\n                console.log(res);\r\n                if (res.code == 200) {\r\n                    const token = res.data.token\r\n                    const user = res.data.user\r\n                    commit('setToken', token)\r\n                    commit('setuser',user)\r\n                    localStorage.setItem('token', token)\r\n                    router.push('/home').catch(() => {})\r\n                    resolve();\r\n                }else{\r\n                    Message({\r\n                        message: '登陆失败  稍后重试',\r\n                        type: \"error\",\r\n                        duration: 3000,\r\n                    })\r\n                    router.push('/login')\r\n                }\r\n            })\r\n            .catch(error=>{\r\n                Message({\r\n                    message: '系统错误',\r\n                    type: \"error\",\r\n                    duration: 3000,\r\n                })\r\n                reject(error)\r\n            })\r\n           })\r\n\r\n        }\r\n    }\r\n})\r\n\r\nexport default store"],"mappings":";AAAA,SAASA,SAAS,QAAQ,YAAY;AACtC,SAASC,OAAO,QAAQ,YAAY;AACpC,OAAOC,GAAG,MAAM,KAAK;AACrB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,UAAU;AAC7BF,GAAG,CAACG,GAAG,CAACF,IAAI,CAAC;AAEb,MAAMG,KAAK,GAAG,IAAIH,IAAI,CAACI,KAAK,CAAC;EACzBC,KAAK,EAAE;IACHC,IAAI,EAAC,IAAI;IACTC,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO;EACvC,CAAC;EACDC,SAAS,EAAE;IACPC,QAAQA,CAACN,KAAK,EAAEE,KAAK,EAAE;MACnBF,KAAK,CAACE,KAAK,GAAGA,KAAK;IACvB,CAAC;IACDK,OAAOA,CAACP,KAAK,EAACC,IAAI,EAAC;MACfD,KAAK,CAACC,IAAI,GAAGA,IAAI;IACrB;EACJ,CAAC;EACDO,OAAO,EAAE;IACLC,KAAKA,CAAC;MAAEC;IAAO,CAAC,EAAEC,IAAI,EAAE;MACrB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAACC,MAAM,KAAG;QACpCtB,SAAS,CAAC;UAACuB,QAAQ,EAACJ,IAAI,CAACI,QAAQ;UAACC,QAAQ,EAACL,IAAI,CAACK;QAAQ,CAAC,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;UACrEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;UAChB,IAAIA,GAAG,CAACG,IAAI,IAAI,GAAG,EAAE;YACjB,MAAMnB,KAAK,GAAGgB,GAAG,CAACP,IAAI,CAACT,KAAK;YAC5B,MAAMD,IAAI,GAAGiB,GAAG,CAACP,IAAI,CAACV,IAAI;YAC1BS,MAAM,CAAC,UAAU,EAAER,KAAK,CAAC;YACzBQ,MAAM,CAAC,SAAS,EAACT,IAAI,CAAC;YACtBE,YAAY,CAACmB,OAAO,CAAC,OAAO,EAAEpB,KAAK,CAAC;YACpCN,MAAM,CAAC2B,IAAI,CAAC,OAAO,CAAC,CAACC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;YACpCX,OAAO,CAAC,CAAC;UACb,CAAC,MAAI;YACDpB,OAAO,CAAC;cACJgC,OAAO,EAAE,YAAY;cACrBC,IAAI,EAAE,OAAO;cACbC,QAAQ,EAAE;YACd,CAAC,CAAC;YACF/B,MAAM,CAAC2B,IAAI,CAAC,QAAQ,CAAC;UACzB;QACJ,CAAC,CAAC,CACDC,KAAK,CAACI,KAAK,IAAE;UACVnC,OAAO,CAAC;YACJgC,OAAO,EAAE,MAAM;YACfC,IAAI,EAAE,OAAO;YACbC,QAAQ,EAAE;UACd,CAAC,CAAC;UACFb,MAAM,CAACc,KAAK,CAAC;QACjB,CAAC,CAAC;MACH,CAAC,CAAC;IAEL;EACJ;AACJ,CAAC,CAAC;AAEF,eAAe9B,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}