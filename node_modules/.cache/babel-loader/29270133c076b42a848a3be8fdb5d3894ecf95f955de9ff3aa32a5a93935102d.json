{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { userLogin } from '@/api/user';\nimport { Message } from 'element-ui';\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport router from '@/router';\nVue.use(Vuex);\nconst store = new Vuex.Store({\n  state: {\n    user: localStorage.getItem('username'),\n    token: localStorage.getItem('token'),\n    navList: JSON.parse(localStorage.getItem('navList'))\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    },\n    setuser(state, user) {\n      state.user = user;\n    },\n    setNavList(state, navList) {\n      state.navList = navList;\n    }\n  },\n  actions: {\n    login({\n      commit\n    }, data) {\n      return new Promise((resolve, reject) => {\n        userLogin({\n          username: data.username,\n          password: data.password\n        }).then(res => {\n          console.log(res);\n          if (res.code == 200) {\n            const token = res.data.token;\n            const user = res.data.user;\n            const navList = res.data.navList;\n            commit('setToken', token);\n            commit('setuser', user);\n            commit('setNavList', navList);\n            localStorage.setItem('token', token);\n            localStorage.setItem('username', user);\n            localStorage.setItem('navList', navList);\n            router.push('/home').catch(() => {});\n            resolve();\n          } else {\n            Message({\n              message: '登陆失败  稍后重试',\n              type: \"error\",\n              duration: 3000\n            });\n            router.push('/login');\n          }\n        }).catch(error => {\n          Message({\n            message: '系统错误',\n            type: \"error\",\n            duration: 3000\n          });\n          reject(error);\n        });\n      });\n    }\n  }\n});\nexport default store;","map":{"version":3,"names":["userLogin","Message","Vue","Vuex","router","use","store","Store","state","user","localStorage","getItem","token","navList","JSON","parse","mutations","setToken","setuser","setNavList","actions","login","commit","data","Promise","resolve","reject","username","password","then","res","console","log","code","setItem","push","catch","message","type","duration","error"],"sources":["D:/Lowcode/vue-low-code/src/store/user.js"],"sourcesContent":["import { userLogin } from '@/api/user'\r\nimport { Message } from 'element-ui'\r\nimport Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport router from '@/router'\r\nVue.use(Vuex)\r\n\r\nconst store = new Vuex.Store({\r\n    state: {\r\n        user:localStorage.getItem('username'),\r\n        token: localStorage.getItem('token'),\r\n        navList:JSON.parse(localStorage.getItem('navList'))\r\n    },\r\n    mutations: {\r\n        setToken(state, token) {\r\n            state.token = token\r\n        },\r\n        setuser(state,user){\r\n            state.user = user\r\n        },\r\n        setNavList(state,navList){\r\n            state.navList = navList\r\n        }\r\n    },\r\n    actions: {\r\n        login({ commit }, data) {\r\n           return new Promise((resolve,reject)=>{\r\n            userLogin({username:data.username,password:data.password}).then((res) => {\r\n                console.log(res);\r\n                if (res.code == 200) {\r\n                    const token = res.data.token\r\n                    const user = res.data.user\r\n                    const navList =  res.data.navList\r\n                    commit('setToken', token)\r\n                    commit('setuser',user)\r\n                    commit('setNavList',navList)\r\n                    localStorage.setItem('token', token)\r\n                    localStorage.setItem('username', user)\r\n                    localStorage.setItem('navList', navList)\r\n                    router.push('/home').catch(() => {})\r\n                    resolve();\r\n                }else{\r\n                    Message({\r\n                        message: '登陆失败  稍后重试',\r\n                        type: \"error\",\r\n                        duration: 3000,\r\n                    })\r\n                    router.push('/login')\r\n                }\r\n            })\r\n            .catch(error=>{\r\n                Message({\r\n                    message: '系统错误',\r\n                    type: \"error\",\r\n                    duration: 3000,\r\n                })\r\n                reject(error)\r\n            })\r\n           })\r\n\r\n        }\r\n    }\r\n})\r\n\r\nexport default store"],"mappings":";AAAA,SAASA,SAAS,QAAQ,YAAY;AACtC,SAASC,OAAO,QAAQ,YAAY;AACpC,OAAOC,GAAG,MAAM,KAAK;AACrB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,MAAM,MAAM,UAAU;AAC7BF,GAAG,CAACG,GAAG,CAACF,IAAI,CAAC;AAEb,MAAMG,KAAK,GAAG,IAAIH,IAAI,CAACI,KAAK,CAAC;EACzBC,KAAK,EAAE;IACHC,IAAI,EAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;IACrCC,KAAK,EAAEF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IACpCE,OAAO,EAACC,IAAI,CAACC,KAAK,CAACL,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;EACtD,CAAC;EACDK,SAAS,EAAE;IACPC,QAAQA,CAACT,KAAK,EAAEI,KAAK,EAAE;MACnBJ,KAAK,CAACI,KAAK,GAAGA,KAAK;IACvB,CAAC;IACDM,OAAOA,CAACV,KAAK,EAACC,IAAI,EAAC;MACfD,KAAK,CAACC,IAAI,GAAGA,IAAI;IACrB,CAAC;IACDU,UAAUA,CAACX,KAAK,EAACK,OAAO,EAAC;MACrBL,KAAK,CAACK,OAAO,GAAGA,OAAO;IAC3B;EACJ,CAAC;EACDO,OAAO,EAAE;IACLC,KAAKA,CAAC;MAAEC;IAAO,CAAC,EAAEC,IAAI,EAAE;MACrB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAACC,MAAM,KAAG;QACpC1B,SAAS,CAAC;UAAC2B,QAAQ,EAACJ,IAAI,CAACI,QAAQ;UAACC,QAAQ,EAACL,IAAI,CAACK;QAAQ,CAAC,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;UACrEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;UAChB,IAAIA,GAAG,CAACG,IAAI,IAAI,GAAG,EAAE;YACjB,MAAMrB,KAAK,GAAGkB,GAAG,CAACP,IAAI,CAACX,KAAK;YAC5B,MAAMH,IAAI,GAAGqB,GAAG,CAACP,IAAI,CAACd,IAAI;YAC1B,MAAMI,OAAO,GAAIiB,GAAG,CAACP,IAAI,CAACV,OAAO;YACjCS,MAAM,CAAC,UAAU,EAAEV,KAAK,CAAC;YACzBU,MAAM,CAAC,SAAS,EAACb,IAAI,CAAC;YACtBa,MAAM,CAAC,YAAY,EAACT,OAAO,CAAC;YAC5BH,YAAY,CAACwB,OAAO,CAAC,OAAO,EAAEtB,KAAK,CAAC;YACpCF,YAAY,CAACwB,OAAO,CAAC,UAAU,EAAEzB,IAAI,CAAC;YACtCC,YAAY,CAACwB,OAAO,CAAC,SAAS,EAAErB,OAAO,CAAC;YACxCT,MAAM,CAAC+B,IAAI,CAAC,OAAO,CAAC,CAACC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;YACpCX,OAAO,CAAC,CAAC;UACb,CAAC,MAAI;YACDxB,OAAO,CAAC;cACJoC,OAAO,EAAE,YAAY;cACrBC,IAAI,EAAE,OAAO;cACbC,QAAQ,EAAE;YACd,CAAC,CAAC;YACFnC,MAAM,CAAC+B,IAAI,CAAC,QAAQ,CAAC;UACzB;QACJ,CAAC,CAAC,CACDC,KAAK,CAACI,KAAK,IAAE;UACVvC,OAAO,CAAC;YACJoC,OAAO,EAAE,MAAM;YACfC,IAAI,EAAE,OAAO;YACbC,QAAQ,EAAE;UACd,CAAC,CAAC;UACFb,MAAM,CAACc,KAAK,CAAC;QACjB,CAAC,CAAC;MACH,CAAC,CAAC;IAEL;EACJ;AACJ,CAAC,CAAC;AAEF,eAAelC,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}