{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\"; //引入axios\nimport env from \"@/api/http/env\";\n\n// 创建axios实例\nconst Request = axios.create({\n  //这里拿线上接口测试\n  baseUrl: env.dev.baseUrl,\n  // headers:{ //请求头\n  //     'Content-Type': 'application/json;charset=UTF-8',\n  // },\n  settimeout: 50000 //超时时间\n});\n// 请求拦截器\nRequest.interceptors.request.use(config => {\n  // 在发送请求之前做些什么 验证token之类的\n  // console.log(\"请求的数据:\", config);\n  if (localStorage.getItem('token')) {\n    config.headers.token = localStorage.getItem('token');\n  }\n  return config; //记得一定要 返回config\n}, error => {\n  // 对请求错误做些什么\n  // console.log(\"请求的数据:\", error);\n  Message.error({\n    message: '请求超时!'\n  });\n  return Promise.reject(error);\n});\n\n// 响应拦截器\nRequest.interceptors.response.use(response => {\n  // console.log(\"返回的数据\", response);\n  // 这里拦截401错误，并重新跳入登页重新获取token\n  if (response.status && response.status === 200) {\n    // 通讯成功\n    if (response.data.code === 0) {\n      return response.data;\n    } else if (response.data.code === 401) {\n      // 如果是token过期，跳转至登录\n      this.$message.error(\"登录已过期，请重新登录！\");\n      localStorage.removeItem('token'); // 移除token，跳转至登录\n      router.push({\n        path: '/Login'\n      });\n    }\n    return Promise.resolve(response.data);\n  }\n}, err => {\n  if (err && err.response) {\n    switch (err.response.status) {\n      case 400:\n        err.message = '请求错误(400)';\n        break;\n      case 401:\n        err.message = '未授权，请重新登录(401)';\n        break;\n      case 403:\n        err.message = '拒绝访问(403)';\n        break;\n      case 404:\n        err.message = '请求出错(404)';\n        break;\n      case 408:\n        err.message = '请求超时(408)';\n        break;\n      case 500:\n        err.message = '服务器错误(500)';\n        break;\n      case 501:\n        err.message = '服务未实现(501)';\n        break;\n      case 502:\n        err.message = '网络错误(502)';\n        break;\n      case 503:\n        err.message = '服务不可用(503)';\n        break;\n      case 504:\n        err.message = '网络超时(504)';\n        break;\n      case 505:\n        err.message = 'HTTP版本不受支持(505)';\n        break;\n      default:\n        err.message = `连接出错(${err.response.status})!`;\n    }\n  } else {\n    err.message = '连接服务器失败!';\n  }\n  Message.err({\n    message: err.message\n  });\n  return Promise.resolve(err);\n});\nexport default Request;","map":{"version":3,"names":["axios","env","Request","create","baseUrl","dev","settimeout","interceptors","request","use","config","localStorage","getItem","headers","token","error","Message","message","Promise","reject","response","status","data","code","$message","removeItem","router","push","path","resolve","err"],"sources":["D:/Lowcode/vue-low-code/src/utils/request.js"],"sourcesContent":["import axios from \"axios\";  //引入axios\r\nimport env from \"@/api/http/env\"; \r\n\r\n// 创建axios实例\r\nconst Request = axios.create({\r\n\t//这里拿线上接口测试\r\n\tbaseUrl: env.dev.baseUrl,\r\n    // headers:{ //请求头\r\n    //     'Content-Type': 'application/json;charset=UTF-8',\r\n    // },\r\n    settimeout:50000,//超时时间\r\n});\r\n// 请求拦截器\r\nRequest.interceptors.request.use(\r\nconfig => {\r\n    // 在发送请求之前做些什么 验证token之类的\r\n    // console.log(\"请求的数据:\", config);\r\n    if (localStorage.getItem('token')) {\r\n      config.headers.token = localStorage.getItem('token')\r\n    }\r\n    return config; //记得一定要 返回config\r\n},\r\nerror => {\r\n    // 对请求错误做些什么\r\n    // console.log(\"请求的数据:\", error);\r\n    Message.error({message: '请求超时!'});\r\n    return Promise.reject(error);\r\n}\r\n);\r\n \r\n// 响应拦截器\r\nRequest.interceptors.response.use(\r\nresponse => {\r\n    // console.log(\"返回的数据\", response);\r\n    // 这里拦截401错误，并重新跳入登页重新获取token\r\n    if (response.status && response.status === 200) {\r\n      // 通讯成功\r\n      if (response.data.code === 0) {\r\n        return response.data\r\n      } else if (response.data.code === 401) { \r\n        // 如果是token过期，跳转至登录\r\n        this.$message.error(\"登录已过期，请重新登录！\");\r\n        localStorage.removeItem('token') // 移除token，跳转至登录\r\n        router.push({ \r\n          path: '/Login'\r\n        })\r\n      }\r\n      return Promise.resolve(response.data)\r\n    }\r\n},\r\nerr => {\r\n    if (err && err.response) {\r\n        switch (err.response.status) {\r\n            case 400: err.message = '请求错误(400)'; break;\r\n            case 401: err.message = '未授权，请重新登录(401)'; break;\r\n            case 403: err.message = '拒绝访问(403)'; break;\r\n            case 404: err.message = '请求出错(404)'; break;\r\n            case 408: err.message = '请求超时(408)'; break;\r\n            case 500: err.message = '服务器错误(500)'; break;\r\n            case 501: err.message = '服务未实现(501)'; break;\r\n            case 502: err.message = '网络错误(502)'; break;\r\n            case 503: err.message = '服务不可用(503)'; break;\r\n            case 504: err.message = '网络超时(504)'; break;\r\n            case 505: err.message = 'HTTP版本不受支持(505)'; break;\r\n            default: err.message = `连接出错(${err.response.status})!`;\r\n        }\r\n    } else {\r\n        err.message = '连接服务器失败!'\r\n    }\r\n  Message.err( {message: err.message } )\r\n  return Promise.resolve(err);\r\n}\r\n);\r\nexport default Request;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}