{"ast":null,"code":"import { gantt } from 'dhtmlx-gantt';\nexport default {\n  name: 'gantt',\n  props: {\n    tasks: {\n      type: Object,\n      default() {\n        return {\n          data: [],\n          links: []\n        };\n      }\n    }\n  },\n  mounted: function () {\n    //日期格式化\n    gantt.config.xml_date = \"%Y-%m\";\n    gantt.config.scale_unit = \"year\"; //按月显示\n    gantt.config.date_scale = \"1\"; //设置时间刻度的格式（X轴） 多个尺度\n\n    gantt.config.scale_height = 50; //设置时间刻度的高度和网格的标题\n\n    gantt.config.subscales = [{\n      unit: \"month\",\n      step: 1,\n      date: \"%M\"\n    }]; //指定第二个时间刻度\n\n    //左侧是否自适应\n    gantt.config.autofit = true;\n    //左侧宽\n    gantt.config.grid_width = 200;\n    //取消连线\n    gantt.config.drag_links = false;\n    //只读\n    gantt.config.readonly = false;\n    //右侧显示列名\n    gantt.config.date_scale = \"%Y-%m-%d\";\n    //自动调整图表坐标轴区间用于适配task的长度\n    gantt.config.fit_tasks = true;\n    //弹窗宽\n    gantt.config.wide_form = false;\n    //汉化\n    gantt.locale = {\n      date: {\n        month_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n        month_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n        day_full: [\"星期日\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"],\n        day_short: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"]\n      },\n      labels: {\n        dhx_cal_today_button: \"今天\",\n        day_tab: \"日\",\n        week_tab: \"周\",\n        month_tab: \"月\",\n        new_event: \"新建日程\",\n        icon_save: \"保存\",\n        icon_cancel: \"关闭\",\n        icon_details: \"详细\",\n        icon_edit: \"编辑\",\n        icon_delete: \"删除\",\n        confirm_closing: \"请确认是否撤销修改!\",\n        //Your changes will be lost, are your sure?\n        confirm_deleting: \"是否删除计划?\",\n        section_description: \"任务内容:\",\n        section_time: \"时间范围:\",\n        section_type: \"类型\",\n        section_text: \"任务名称:\",\n        section_color: \"颜色:\",\n        /* grid columns */\n\n        column_text: \"项目节点名称\",\n        column_start_date: \"开始时间\",\n        column_duration: \"持续时间\",\n        column_add: \"\",\n        /* link confirmation */\n\n        link: \"关联\",\n        confirm_link_deleting: \"将被删除\",\n        link_start: \" (开始)\",\n        link_end: \" (结束)\",\n        type_task: \"任务\",\n        type_project: \"项目\",\n        type_milestone: \"里程碑\",\n        minutes: \"分钟\",\n        hours: \"小时\",\n        days: \"天\",\n        weeks: \"周\",\n        months: \"月\",\n        years: \"年\"\n      }\n    };\n    //左侧显示列名\n    gantt.config.columns = [{\n      name: \"text\",\n      label: \"任务名称\",\n      tree: true,\n      width: '*'\n    }\n    // { name: \"start_date\", label: \"开始时间\", align: \"center\" },\n    // { name: \"end_date\", label: \"结束时间\", align: \"center\" },\n    // {\n    //   name: \"progress\", label: \"进度\", align: \"center\",\n    //   template: function (obj) {\n    //     return (Math.floor(obj.progress * 100)).toString() + '%'\n    //   }\n    // },\n    // { name: \"add\", label: \"\" },\n    ];\n    //弹出层\n    gantt.config.lightbox.sections = [{\n      name: \"text\",\n      height: 70,\n      map_to: \"text\",\n      type: \"textarea\",\n      focus: true,\n      width: 200\n    }, {\n      name: \"time\",\n      height: 30,\n      map_to: \"auto\",\n      type: \"time\",\n      time_format: [\"%Y\", \"%m\", \"%d\"]\n    }, {\n      name: \"color\",\n      height: 30,\n      map_to: \"color\",\n      type: \"select\",\n      options: [{\n        key: \"#3db9d3\",\n        label: \"蓝色\"\n      }, {\n        key: \"#33cc33\",\n        label: \"绿色\"\n      }, {\n        key: \"#FF8247\",\n        label: \"橙色\"\n      }, {\n        key: \"#ff6633\",\n        label: \"红色\"\n      }]\n    }, {\n      name: \"description\",\n      height: 70,\n      map_to: \"description\",\n      type: \"textarea\"\n    }];\n    //弹窗标题 日期范围\n    gantt.templates.task_time = function (start, end, task) {\n      return moment(start).format('YYYY-MM-DD') + \" - \" + moment(end).format('YYYY-MM-DD');\n    };\n    //弹窗标题 计划名称\n    gantt.templates.task_text = function (start, end, task) {\n      return task.text;\n    };\n    gantt.init(this.$refs.gantt);\n    gantt.parse(this.$props.tasks);\n    let this_ = this;\n    //添加后触发\n    gantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\n      console.log(\"添加后触发\");\n      this_.changeTask();\n    });\n    //移动进度后触发\n    gantt.attachEvent(\"onAfterTaskDrag\", function (id, mode, e) {\n      console.log(\"移动进度后触发\");\n      this_.changeTask();\n    });\n    //移动任务后触发\n    gantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\n      console.log(\"移动任务后触发\");\n      this_.changeTask();\n    });\n    //删除任务后触发\n    gantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\n      console.log(\"删除任务后触发\");\n      this_.changeTask();\n    });\n    //修改任务后触发\n    gantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\n      console.log(\"修改任务后触发\");\n      this_.changeTask();\n    });\n    //保存验证\n    gantt.attachEvent(\"onLightboxSave\", function (id, item) {\n      if (!item.text) {\n        gantt.message({\n          type: \"error\",\n          text: \"请填写任务名称!\"\n        });\n        return false;\n      }\n      return true;\n    });\n  }\n};","map":{"version":3,"names":["gantt","name","props","tasks","type","Object","default","data","links","mounted","config","xml_date","scale_unit","date_scale","scale_height","subscales","unit","step","date","autofit","grid_width","drag_links","readonly","fit_tasks","wide_form","locale","month_full","month_short","day_full","day_short","labels","dhx_cal_today_button","day_tab","week_tab","month_tab","new_event","icon_save","icon_cancel","icon_details","icon_edit","icon_delete","confirm_closing","confirm_deleting","section_description","section_time","section_type","section_text","section_color","column_text","column_start_date","column_duration","column_add","link","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","minutes","hours","days","weeks","months","years","columns","label","tree","width","lightbox","sections","height","map_to","focus","time_format","options","key","templates","task_time","start","end","task","moment","format","task_text","text","init","$refs","parse","$props","this_","attachEvent","id","item","console","log","changeTask","mode","e","parent","tindex","message"],"sources":["src/components/Gantt/Gantetu.vue"],"sourcesContent":["<template>\r\n  <div ref=\"gantt\"></div>\r\n</template>\r\n\r\n<script>\r\nimport { gantt } from 'dhtmlx-gantt';\r\nexport default {\r\nname: 'gantt',\r\nprops: {\r\n  tasks: {\r\n    type: Object,\r\n    default () {\r\n      return { data: [], links: [] }\r\n    }\r\n  }\r\n},\r\n\r\nmounted: function () {\r\n  //日期格式化\r\n  gantt.config.xml_date = \"%Y-%m\";\r\n\r\n  gantt.config.scale_unit = \"year\";\t//按月显示\r\n  gantt.config.date_scale = \"1\";\t\t//设置时间刻度的格式（X轴） 多个尺度\r\n\r\n  gantt.config.scale_height = 50; //设置时间刻度的高度和网格的标题\r\n\r\n  gantt.config.subscales = [\r\n    { unit: \"month\", step: 1, date: \"%M\" }\r\n  ];\t\t\t//指定第二个时间刻度\r\n\r\n  //左侧是否自适应\r\n  gantt.config.autofit = true;\r\n  //左侧宽\r\n  gantt.config.grid_width = 200;\r\n  //取消连线\r\n  gantt.config.drag_links = false;\r\n  //只读\r\n  gantt.config.readonly = false;\r\n  //右侧显示列名\r\n  gantt.config.date_scale = \"%Y-%m-%d\";\r\n  //自动调整图表坐标轴区间用于适配task的长度\r\n  gantt.config.fit_tasks = true;\r\n  //弹窗宽\r\n  gantt.config.wide_form = false;\r\n  //汉化\r\n  gantt.locale = {\r\n    date: {\r\n      month_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n      month_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\r\n      day_full: [\"星期日\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"],\r\n      day_short: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"]\r\n    },\r\n    labels: {\r\n      dhx_cal_today_button: \"今天\",\r\n      day_tab: \"日\",\r\n      week_tab: \"周\",\r\n      month_tab: \"月\",\r\n      new_event: \"新建日程\",\r\n      icon_save: \"保存\",\r\n      icon_cancel: \"关闭\",\r\n      icon_details: \"详细\",\r\n      icon_edit: \"编辑\",\r\n      icon_delete: \"删除\",\r\n      confirm_closing: \"请确认是否撤销修改!\", //Your changes will be lost, are your sure?\r\n      confirm_deleting: \"是否删除计划?\",\r\n      section_description: \"任务内容:\",\r\n      section_time: \"时间范围:\",\r\n      section_type: \"类型\",\r\n      section_text: \"任务名称:\",\r\n      section_color: \"颜色:\",\r\n\r\n      /* grid columns */\r\n\r\n      column_text: \"项目节点名称\",\r\n      column_start_date: \"开始时间\",\r\n      column_duration: \"持续时间\",\r\n      column_add: \"\",\r\n\r\n      /* link confirmation */\r\n\r\n      link: \"关联\",\r\n      confirm_link_deleting: \"将被删除\",\r\n      link_start: \" (开始)\",\r\n      link_end: \" (结束)\",\r\n\r\n      type_task: \"任务\",\r\n      type_project: \"项目\",\r\n      type_milestone: \"里程碑\",\r\n\r\n      minutes: \"分钟\",\r\n      hours: \"小时\",\r\n      days: \"天\",\r\n      weeks: \"周\",\r\n      months: \"月\",\r\n      years: \"年\"\r\n    }\r\n  }\r\n  //左侧显示列名\r\n  gantt.config.columns = [\r\n    { name: \"text\", label: \"任务名称\", tree: true, width: '*' },\r\n    // { name: \"start_date\", label: \"开始时间\", align: \"center\" },\r\n    // { name: \"end_date\", label: \"结束时间\", align: \"center\" },\r\n    // {\r\n    //   name: \"progress\", label: \"进度\", align: \"center\",\r\n    //   template: function (obj) {\r\n    //     return (Math.floor(obj.progress * 100)).toString() + '%'\r\n    //   }\r\n    // },\r\n    // { name: \"add\", label: \"\" },\r\n  ];\r\n  //弹出层\r\n  gantt.config.lightbox.sections = [\r\n    { name: \"text\", height: 70, map_to: \"text\", type: \"textarea\", focus: true, width: 200 },\r\n    { name: \"time\", height: 30, map_to: \"auto\", type: \"time\", time_format: [\"%Y\", \"%m\", \"%d\"] },\r\n    {\r\n      name: \"color\", height: 30, map_to: \"color\", type: \"select\", options: [\r\n        { key: \"#3db9d3\", label: \"蓝色\" },\r\n        { key: \"#33cc33\", label: \"绿色\" },\r\n        { key: \"#FF8247\", label: \"橙色\" },\r\n        { key: \"#ff6633\", label: \"红色\" }\r\n      ]\r\n    },\r\n    { name: \"description\", height: 70, map_to: \"description\", type: \"textarea\" }\r\n  ];\r\n  //弹窗标题 日期范围\r\n  gantt.templates.task_time = function (start, end, task) {\r\n    return moment(start).format('YYYY-MM-DD') + \" - \" + moment(end).format('YYYY-MM-DD');\r\n  };\r\n  //弹窗标题 计划名称\r\n  gantt.templates.task_text = function (start, end, task) {\r\n    return task.text;\r\n  };\r\n  gantt.init(this.$refs.gantt);\r\n  gantt.parse(this.$props.tasks);\r\n  let this_ = this\r\n  //添加后触发\r\n  gantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\r\n    console.log(\"添加后触发\");\r\n    this_.changeTask();\r\n  });\r\n  //移动进度后触发\r\n  gantt.attachEvent(\"onAfterTaskDrag\", function (id, mode, e) {\r\n    console.log(\"移动进度后触发\");\r\n    this_.changeTask();\r\n  });\r\n  //移动任务后触发\r\n  gantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\r\n    console.log(\"移动任务后触发\");\r\n    this_.changeTask();\r\n  });\r\n  //删除任务后触发\r\n  gantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\r\n    console.log(\"删除任务后触发\");\r\n    this_.changeTask();\r\n  });\r\n  //修改任务后触发\r\n  gantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\r\n    console.log(\"修改任务后触发\");\r\n    this_.changeTask();\r\n  })\r\n  //保存验证\r\n  gantt.attachEvent(\"onLightboxSave\", function (id, item) {\r\n    if (!item.text) {\r\n      gantt.message({ type: \"error\", text: \"请填写任务名称!\" });\r\n      return false;\r\n    }\r\n    return true;\r\n  });\r\n}\r\n}\r\n</script>\r\n\r\n<style>\r\n@import 'dhtmlx-gantt/codebase/dhtmlxgantt.css';\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}